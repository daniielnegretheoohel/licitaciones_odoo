<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record id="view_meta_personal_list" model="ir.ui.view">
        <field name="name">meta.personal.list</field>
        <field name="model">meta.personal</field>
        <field name="type">list</field>
        <field name="arch" type="xml">
            <list string="Metas Personales"
                  decoration-success="estado == 'completado'"
                  decoration-danger="estado == 'no_logrado'"
                  decoration-warning="estado == 'en_pausa'"
                  decoration-info="estado == 'en_progreso'">

                <header>
                    <button name="action_marcar_varias_completadas"
                            type="object"
                            string="Marcar seleccionadas como completadas"
                            class="btn-primary"/>
                </header>

                <field name="nombre"/>
                <field name="categoria"/>
                <field name="estado" widget="badge"/>
                <field name="fecha_limite"/>
                <field name="actividad_count"/>
                <field name="recomendacion_count"/>
                <field name="dias_restantes"/>
            </list>
        </field>
    </record>

    <record id="view_metas_personales_form" model="ir.ui.view">
        <field name="name">meta.personal.form</field>
        <field name="model">meta.personal</field>
        <field name="arch" type="xml">
            <form string="Meta Personal">

                <header>

                    <button name="action_avanzar"
                            type="object"
                            string="Avanzar →"
                            class="btn-primary"
                            modifiers='{"invisible": [["estado","in",["completado","no_logrado"]]]}'/>

                    <button name="action_retroceder"
                            type="object"
                            string="← Retroceder"
                            class="btn-secondary"
                            modifiers='{"invisible": [["estado","=","borrador"]]}'/>

                    <button name="action_marcar_completado"
                            type="object"
                            string="Marcar como Completado ✔"
                            class="oe_highlight"
                            modifiers='{"invisible": [["estado","=","completado"]]}'/>

                    <button name="action_meta_personal_report"
                            string="Imprimir Meta"
                            type="object"
                            class="btn-secondary"/>

                    <field name="estado"
                           widget="statusbar"
                           statusbar_visible="borrador,en_progreso,en_pausa,completado,no_logrado"/>

                </header>

                <div class="oe_button_box" name="button_box">

                    <button class="oe_stat_button"
                            type="object"
                            name="open_actividades"
                            icon="fa-check-circle">
                        <field string="Actividades" name="actividad_count" widget="statinfo"/>
                    </button>

                    <button class="oe_stat_button"
                            type="object"
                            name="open_recomendaciones"
                            icon="fa-lightbulb">
                        <field string="Recomendaciones" name="recomendacion_count" widget="statinfo"/>
                    </button>

                </div>

                <sheet>

                    <!-- Título -->
                    <div class="oe_title">
                        <label for="nombre" string="Nombre de la Meta"/>
                        <h1>
                            <field name="nombre" placeholder="Escribe el nombre de tu meta"/>
                        </h1>
                    </div>

                    <!-- Grupo principal -->
                    <group>
                        <group>
                            <field name="categoria"/>
                            <field name="fecha_limite"/>
                        </group>

                        <group>
                            <field name="prioridad"/>
                        </group>

                        <group>
                            <field name="etiqueta_ids" widget="many2many_tags"/>
                        </group>

                        <group>
                            <field name="dias_restantes"/>
                        </group>

                        <group>
                            <field name="actividad_count"/>
                            <field name="recomendacion_count"/>
                        </group>

                        <group>
                            <field name="estado" invisible="1"/>
                        </group>
                    </group>

                    <!-- Notebook con pestañas -->
                    <notebook>

                        <page string="Descripción">
                            <field name="descripcion"/>
                        </page>

                        <page string="Recomendaciones">
                            <field name="recomendacion_ids" mode="list,form">

                                <list editable="bottom">
                                    <field name="tipo_recomendacion"/>
                                    <field name="descripcion"/>
                                    <field name="descripcion"/>
                                </list>

                                <form>
                                    <group>
                                        <field name="tipo_recomendacion"/>
                                        <field name="descripcion"/>
                                        <field name="descripcion"/>
                                    </group>
                                </form>

                            </field>
                        </page>

                        <page string="Actividades">
                            <field name="actividad_ids" mode="list,form">

                                <list editable="bottom">
                                    <field name="fecha"/>
                                    <field name="tipo_actividad"/>
                                    <field name="descripcion"/>
                                </list>

                                <form>
                                    <group>
                                        <field name="fecha"/>
                                        <field name="tipo_actividad"/>
                                        <field name="descripcion"/>
                                    </group>
                                </form>

                            </field>
                        </page>

                    </notebook>

                </sheet>
            </form>
        </field>
    </record>

    <record id="action_metas_personales" model="ir.actions.act_window">
        <field name="name">Metas Personales</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">meta.personal</field>
        <field name="view_mode">list,form</field>
    </record>
</odoo>